<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Weighted Fused LASSO Signal Approximator (wFLSA) â€¢ wflsa</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Weighted Fused LASSO Signal Approximator (wFLSA)">
<meta name="description" content="A package for computing the Weighted Fused LASSO Signal Approximator (wFLSA).">
<meta property="og:description" content="A package for computing the Weighted Fused LASSO Signal Approximator (wFLSA).">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">wflsa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bips-hb/wflsa/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="covariate-varying-networks">Covariate-Varying Networks<a class="anchor" aria-label="anchor" href="#covariate-varying-networks"></a>
</h1></div>
<p>Louis Dijkstra 2025-05-23</p>
<ul>
<li>
<a href="#wflsa-weighted-fused-lasso-signal-approximator"><code>wflsa</code>: Weighted Fused LASSO Signal Approximator</a>
<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#problem-formulation">Problem Formulation</a></li>
<li><a href="#example-use">Example Use</a></li>
<li><a href="#acknowledgment">Acknowledgment</a></li>
</ul>
</li>
</ul>
<!-- README.md is generated from README.Rmd. Please edit that file -->
</div>
<div class="section level1">
<h1 id="wflsa-weighted-fused-lasso-signal-approximator">
<code>wflsa</code>: Weighted Fused LASSO Signal Approximator<a class="anchor" aria-label="anchor" href="#wflsa-weighted-fused-lasso-signal-approximator"></a>
</h1>
<p>The <strong>wflsa</strong> R package provides an efficient implementation of an algorithm for solving the Weighted Fused LASSO Signal Approximator problem. This algorithm is based on an ADMM (Alternating Direction Method of Multipliers) approach and is designed to estimate a vector of coefficients with sparsity and smoothness constraints.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the package from GitHub using <code>pak</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"bips-hb/wflsa"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="problem-formulation">Problem Formulation<a class="anchor" aria-label="anchor" href="#problem-formulation"></a>
</h2>
<p>The problem solved by the wFLSA algorithm is formulated as follows:</p>
<div class="float">
<embed src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cbeta%7D%20%3D%20%5Cunderset%7B%5Cbeta%7D%7B%5Carg%5Cmin%7D%20%5Cleft%28%20%5Cfrac%7B1%7D%7B2%7D%20%5C%7C%20y%20-%20%5Cbeta%20%5C%7C_2%5E2%20%2B%20%5Clambda_1%20%0A%5C%7C%20%5Cbeta%20%5C%7C_1%20%2B%20%5Clambda_2%20%5Csum_%7Bi%20%3C%20j%7D%20w_%7Bij%7D%20%7C%20%5Cbeta_i%20-%20%5Cbeta_j%20%7C%20%5Cright%29" title="\hat{\beta} = \underset{\beta}{\arg\min} \left( \frac{1}{2} | y - \beta |_2^2 + \lambda_1 | \beta |_1 + \lambda_2 \sum_{i &lt; j} w_{ij} | \beta_i - \beta_j | \right)"></embed><div class="figcaption"> =  (  \ y - \_2^2 + _1 \ \_1 + _2 _{i &lt; j} w_{ij} | _i - _j | )</div>
</div>
<p>Where:</p>
<ul>
<li>
<embed src="https://latex.codecogs.com/png.latex?y" title="y"></embed> is the response variable with mean 0.</li>
<li>
<embed src="https://latex.codecogs.com/png.latex?%5Cbeta" title="\beta"></embed> is the vector of coefficients to be estimated.</li>
<li>
<embed src="https://latex.codecogs.com/png.latex?%7C%7C%20%5Ccdot%20%7C%7C_1" title="|| \cdot ||_1"></embed> and <embed src="https://latex.codecogs.com/png.latex?%7C%7C%20%5Ccdot%20%7C%7C_2" title="|| \cdot ||_2"></embed> are the <embed src="https://latex.codecogs.com/png.latex?L_1" title="L_1"></embed>- and <embed src="https://latex.codecogs.com/png.latex?L_2" title="L_2"></embed>-norms, respectively.</li>
<li>
<embed src="https://latex.codecogs.com/png.latex?%5Clambda_1%20%3E%200" title="\lambda_1 &gt; 0"></embed> is the regularization parameter controlling the strength of the sparsity penalty.</li>
<li>
<embed src="https://latex.codecogs.com/png.latex?%5Clambda_2%20%3E%200" title="\lambda_2 &gt; 0"></embed> is the regularization parameter controlling the smoothness.</li>
<li>
<embed src="https://latex.codecogs.com/png.latex?w_%7Bij%7D%20%5Cin%20%5B0%2C1%5D" title="w_{ij} \in [0,1]"></embed> is the weight between the <embed src="https://latex.codecogs.com/png.latex?i" title="i"></embed>-th and <embed src="https://latex.codecogs.com/png.latex?j" title="j"></embed>-th coefficient.</li>
</ul>
</div>
<div class="section level2">
<h2 id="example-use">Example Use<a class="anchor" aria-label="anchor" href="#example-use"></a>
</h2>
<p>A simple example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bips-hb/wflsa" class="external-link">wflsa</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># number of covariates</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co"># the response vector</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fully connected (Weight matrix is 1)</span></span>
<span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># lambda values:</span></span>
<span><span class="va">lambda1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">lambda2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Solve the weighted Fused LASSO Signal Approximator</span></span>
<span><span class="fu"><a href="reference/wflsa.html">wflsa</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">W</span>, <span class="va">lambda1</span>, <span class="va">lambda2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Weighted Fused LASSO Signal Approximator</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of variables (p) : 10</span></span>
<span><span class="co">#&gt; Number of lambda pairs  : 9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated beta coefficients </span></span>
<span><span class="co">#&gt; (0.01, 0.01):    -0.70   0.05    -0.87   1.36    0.18    -0.87   0.32    0.53    ...</span></span>
<span><span class="co">#&gt; (0.10, 0.01):    -0.61   0.00    -0.78   1.27    0.09    -0.78   0.23    0.44    ...</span></span>
<span><span class="co">#&gt; (0.20, 0.01):    -0.51   0.00    -0.68   1.17    0.00    -0.68   0.13    0.34    ...</span></span>
<span><span class="co">#&gt; (0.01, 0.10):    -0.18   0.02    -0.18   0.55    0.02    -0.18   0.02    0.02    ...</span></span>
<span><span class="co">#&gt; (0.10, 0.10):    -0.09   0.00    -0.09   0.46    0.00    -0.09   0.00    0.00    ...</span></span>
<span><span class="co">#&gt; ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of non-zero coefficients:</span></span>
<span><span class="co">#&gt; 10 9 8 10 5 1 0 0 0</span></span></code></pre></div>
<p>A more involved exaples:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">flsa</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Paket 'flsa' wurde unter R Version 4.4.3 erstellt</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Paket 'ggplot2' wurde unter R Version 4.4.3 erstellt</span></span>
<span></span>
<span><span class="co"># number of parameters. NOTE: is fixed here</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># the average</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span> <span class="op">*</span> <span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mu</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">mu</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generating the data</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="va">mu</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># band_matrix function creates a square matrix with a band around the diagonal.</span></span>
<span><span class="co"># Parameters:</span></span>
<span><span class="co">#   - p: Size of the square matrix.</span></span>
<span><span class="co"># Usage: band_matrix(p)</span></span>
<span><span class="co"># Default band width is set to 1, but it can be adjusted as needed.</span></span>
<span></span>
<span><span class="va">band_matrix</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">band_width</span> <span class="op">&lt;-</span> <span class="fl">1</span>  <span class="co"># Adjust the band width as needed</span></span>
<span>  </span>
<span>  <span class="co"># Create a matrix with a band around the diagonal</span></span>
<span>  <span class="va">my_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">p</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">i</span> <span class="op">-</span> <span class="va">band_width</span><span class="op">)</span></span>
<span>    <span class="va">upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">i</span> <span class="op">+</span> <span class="va">band_width</span><span class="op">)</span></span>
<span>    <span class="va">my_matrix</span><span class="op">[</span><span class="va">i</span>, <span class="va">lower</span><span class="op">:</span><span class="va">upper</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>    </span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">my_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span>  <span class="co"># Set diagonal elements to 0 (optional, as they are already 1)</span></span>
<span>  <span class="va">my_matrix</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># creating the weight matrix commonly used for the 1-dimensional fused lasso signal approximator</span></span>
<span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu">band_matrix</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/wflsa.html">wflsa</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">W</span>, lambda1 <span class="op">=</span> <span class="fl">1</span>, lambda2 <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">fit_flsa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu">flsa</span><span class="op">(</span><span class="va">y</span>, lambda1 <span class="op">=</span> <span class="fl">.1</span>, lambda2 <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  index <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">p</span>, </span>
<span>  mu <span class="op">=</span> <span class="va">mu</span>,</span>
<span>  y <span class="op">=</span> <span class="va">y</span>, </span>
<span>  beta_fit <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">betas</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, </span>
<span>  beta_fit_flsa <span class="op">=</span> <span class="va">fit_flsa</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span><span class="va">index</span>, <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'blue'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span><span class="va">index</span>, <span class="va">beta_fit</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span><span class="va">index</span>, <span class="va">mu</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'purple'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"value"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"variable"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Raw data (blue) and fitted values (red)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="acknowledgment">Acknowledgment<a class="anchor" aria-label="anchor" href="#acknowledgment"></a>
</h2>
<p>DFG - Deutsche Forschungsgemeinschaft (FO 1045/2-1)</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/bips-hb/wflsa/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/bips-hb/wflsa/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing wflsa</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Louis Dijkstra <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-1476-6202" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Ronja Foraita <br><small class="roles"> Maintainer </small> <a href="https://orcid.org/0000-0003-2216-6653" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Leibniz Institute for Prevention Research and Epidemiology - BIPS <br><small class="roles"> Copyright holder, funder </small>  <a href="https://ror.org/02c22vc57" class="external-link"><img src="https://raw.githubusercontent.com/ror-community/ror-logos/main/ror-icon-rgb.svg" class="ror" alt="ROR"></a> </li>
<li>Deutsche Forschungsgemeinschaft (DFG) <br><small class="roles"> Funder </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louis Dijkstra, Ronja Foraita, Leibniz Institute for Prevention Research and Epidemiology - BIPS, Deutsche Forschungsgemeinschaft (DFG).</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
